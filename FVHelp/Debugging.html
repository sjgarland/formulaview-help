<!DOCTYPE HTML> 
<html lang="en">

<head>
  <title>Formula View Help: Debugging a Formula</title>
  <link href="style.css" rel="stylesheet" type="text/css">
  <script type="text/javascript" src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML'></script>
</head>

<body>

  <div id="header">
    <img id="logo" src="Images/fv.png" alt="Formula View logo">
    <div id="logoTitle">Formula View<div id="logoSubtitle">Documentation</div></div>
    <span id="headerTitle">Debugging a Formula</span>
    <span id="headerNav">
      <a href="Uses.html">&#11014; Use cases</a><br>
      <a href="Parentheses.html">&#11013; Dealing with parentheses</a><br>
      <a href="Examining.html">&#10145; Examining a long formula</a>
    </span>
  </div>
  
  <p>
    Spreadsheet formulas can be hard to get right, even when copied from published definitions, like
    this one for the familiar bell-shaped curve.
  </p>
  
  <div class="figure">
    <img  src="Images/BellCurve/BellCurve.jpg" alt="Picture of bell curve and defining equation">
    <span class="caption">Mathematical definition of bell curve</span>
  </div>
  
  <p>
    This spreadsheet shown below tries to plot the bell-shaped curve, but gets it seriously wrong.
  </p>
  
  <div class="figure">
    <img src="Images/BellCurve/Abnormal.png" alt="Spreadsheet with incorrect bell curve">
    <span class="caption">Problematic transcription into Excel</span>
  </div>
  
  <p>
    Formula View helps users find what causes problems like this.  To use it, select the cell
    <code>B2</code> and click the <code>Get</code> button in the <code>Formula View</code>
    tab on Excel's ribbon.
  </p>
  
  <div class="figure">
    <img src="Images/BellCurve/Ribbon.png" alt="Formula View ribbon">
    <span class="caption">Selecting a formula for Formula View</span>
  </div>
  
  <p>
    This action causes Excel to display the Formula View pane, which presents
    three views of the formula in cell <code>B2</code>. (The width of the pane shown
    here was increased by dragging its edge to the left.)
  </p>
  
  <div class="figure">
    <img  src="Images/BellCurve/Views.png" alt="Formula View of incorrect formula">
    <span class="caption">Formula View of problematic formula</span>
  </div>
  
  <ul>
    <li>
      The <a href="TextView.html">text view</a> shows the formula's
      text, as it appears in Excel's formula bar.  Nothing looks wrong in this view.
    </li>
    <li>The <a href="MathView.html">math view</a> typesets the formula,
      making it much easier to read.  Nothing looks wrong in this view either.
    </li>
    <li>
      The <a href="TreeView.html">tree view</a> shows how Excel
      decomposes the formula into smaller expressions, and it shows
      the values of those expressions. The top value looks
      decidedly wrong.
    </li>
  </ul>
  
  <p>
    We trace the origin of this incorrect value by looking at other values lower in the tree
    view.  The problem becomes clear when we examine the box containing the unary minus sign in
    <code>-A2^2</code>: Excel has computed <code>-A2</code> and then squared the result.  We expected
    it to square <code>A2</code> first, as is customary in ordinary mathematical usage and most
    programming languages.
  </p>
  
  <div class="figure">
    <img src="Images/BellCurve/MinusA2Squared.png"= alt="Excel decomposition of -A2^2">
    <span class="caption">Excel decomposition of -A2^2</span>
  </div>
  
  <p>
    We fix the problem by using Excel's formula bar to enclose <code>A2^2</code> in parentheses.  To
    check that this solves the problem, we use the <code>Get</code> button again to reload the formula
    in cell <code>B2</code> into Formula View.  Now the top value looks right in the tree view.
  </p>

  <div class="figure">
    <img  src="Images/BellCurve/NewTreeView.png" alt="Tree view of corrected formula">
    <span class="caption">Tree view of corrected formula</span>
  </div>
  
  <p>
    We finish the repair by copying the corrected formula down from cell <code>B2</code> through cell
    <code>B32</code> and see that it does indeed produce the expected bell-shaped curve.
  </p>
  
  <div class="figure">
    <img src="Images/BellCurve/Normal.png" alt="Spreadsheet with corrected formula">
    <span class="caption">Corrected transcription into Excel</span>
  </div>
  
  <div id="footer">
    <span class="nav"><a href="Parentheses.html">&#11013; Dealing with parentheses</a></span>
    <span class="nav center"><a href="Uses.html">&#11014; Use cases</a></span>
    <span class="nav right"><a href="Examining.html">Examining a long formula &#10145;</a></span>
  </div>
  
</body>
</html>
